<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>GLBã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç¢ºèªãƒ„ãƒ¼ãƒ«</title>
  <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>

  <style>
    #info {
      position: fixed;
      top: 10px;
      left: 10px;
      background: rgba(255, 255, 255, 0.85);
      padding: 10px 14px;
      border-radius: 6px;
      font-size: 14px;
      font-family: sans-serif;
      color: #333;
      z-index: 1000;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }
  </style>
</head>

<body>
  <div id="info">ğŸ”„ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³èª­ã¿è¾¼ã¿ä¸­...</div>

  <a-scene>
    <a-assets>
      <!-- æç«œãƒ¢ãƒ‡ãƒ«ï¼ˆåˆ¥ãƒ¢ãƒ‡ãƒ«ã«å·®ã—æ›¿ãˆã¦ã‚‚OKï¼‰ -->
      <a-asset-item id="dinoModel" src="./assets/glb/apatosaurus.glb"></a-asset-item>
    </a-assets>

    <!-- ãƒ¢ãƒ‡ãƒ«ã®è¡¨ç¤ºä½ç½®ã‚’å°‘ã—ä¸Šã«èª¿æ•´ -->
    <a-gltf-model id="dino" src="#dinoModel" position="0 1 -3" scale="0.1 0.1 0.1"></a-gltf-model>

    <a-camera><a-cursor></a-cursor></a-camera>
    <a-sky color="#CCE6FF"></a-sky>

    <!-- åœ°é¢ã‚‚ä¸Šã«ã‚ã’ã‚‹ -->
    <a-plane color="#77DD77" rotation="-90 0 0" width="30" height="30" position="0 0.5 0"></a-plane>
  </a-scene>

  <script>
    const model = document.querySelector('#dino');
    const infoBox = document.getElementById('info');

    model.addEventListener('model-loaded', () => {
      const animations = model.getObject3D('mesh').animations;

      if (!animations || animations.length === 0) {
        infoBox.textContent = 'âš ï¸ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“';
        console.warn('ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
        return;
      }

      console.log('ğŸ¬ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¯ãƒªãƒƒãƒ—ä¸€è¦§:');
      animations.forEach((clip, i) => {
        console.log(`Clip ${i + 1}: ${clip.name}`);
      });

      let currentIndex = 0;

      const playNextAnimation = () => {
        const clipName = animations[currentIndex].name;

        // ä¸€åº¦ animation-mixer ã‚’å‰Šé™¤ã—ã¦ã‹ã‚‰å†è¨­å®š
        model.removeAttribute('animation-mixer');

        setTimeout(() => {
          model.setAttribute('animation-mixer', `clip: ${clipName}; loop: once`);
          infoBox.textContent = `â–¶ï¸ å†ç”Ÿä¸­: ${clipName}`;
          console.log(`âœ… å†ç”Ÿä¸­: ${clipName}`);

          currentIndex = (currentIndex + 1) % animations.length;
          setTimeout(playNextAnimation, 2000); // â† â± 2ç§’å¾Œã«æ¬¡ã¸
        }, 100); // â† å¿…è¦ãªå°ã•ãªé…å»¶ï¼ˆæ›´æ–°ã‚’ç¢ºå®Ÿã«ã™ã‚‹ãŸã‚ï¼‰
      };

      // ã‚¹ã‚¿ãƒ¼ãƒˆ
      playNextAnimation();
    });
  </script>
</body>

</html>